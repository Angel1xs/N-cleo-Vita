<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Future of the Earth</title>
    
    <link rel="stylesheet" href="vars.css" />
    <link rel="stylesheet" href="styles.css" />
    
</head>
<body>

    <div id="intro-screen" class="full-screen-overlay">
      <h1>Future of the Earth</h1>
      <p>Welcome to the simulation. Your decisions will affect the planet's future.<br>
      Press **ENTER** to continue.</p>
      <button id="startButton">Start Simulation</button>
    </div>

    <div id="context-screen" class="full-screen-overlay hidden">
      <h2>Mission: Terra Satellite</h2>
      <p>
        For 25 years, the Terra satellite orbited the Earth, observing every change: fires, 
        droughts, disappearing glaciers, and air pollution. 
        Its instruments collected millions of data points that now serve as a global 
        decision-making tool. 
        Since its launch in 1999, it has helped us understand how humans transform the world.
      </p>
      <p>(Press **ENTER** to continue)</p>
    </div>
    
    <div id="timeline-screen" class="full-screen-overlay hidden">
        <h2>Timeline: 25 Years that Changed the Planet</h2>
        <div id="timeline-content">
            <p><strong>1999</strong> – Hurricane "Mitch" (Central America). The storm devastated Honduras and Nicaragua. Terra began its mission observing a planet wounded by extreme events.</p>
            <p><strong>2004</strong> – Fires in Argentina. Fire ravaged the Chaco. MODIS recorded the first major regional hotspots.</p>
            <p><strong>2005</strong> – Hurricane "Katrina" (US & Caribbean). One of the most destructive hurricanes of the century, it showed the hemisphere's vulnerability to intense weather events.</p>
            <p><strong>2010</strong> – Oil Spill in the Gulf of Mexico. ASTER and MOPITT detected the spread of pollution. It became one of the biggest modern ecological crises.</p>
            <p><strong>2015</strong> – Heatwaves in Mexico. Record temperatures tested electrical systems and public health. ASTER registered the thermal increase in major cities.</p>
            <p><strong>2017</strong> – Giant Snake Sighting in the Amazon. Monitoring revealed high biodiversity in protected areas, reinforcing the importance of conservation.</p>
            <p><strong>2019</strong> – Reforestation Project in Pachaj, Guatemala. Local communities led forest restoration, showing that positive change can also be measured from space.</p>
            <p><strong>2020</strong> – COVID-19 Pandemic. Global emissions dropped for the first time in decades. Terra registered cleaner skies and a brief respite for Earth.</p>
            <p><strong>2023</strong> – Fires in South America. Brazil, Bolivia, and others faced massive fires. MODIS and MOPITT recorded record levels of pollution.</p>
            <p><strong>2025</strong> – International Year of Glacier Conservation. The world unites to protect icy ecosystems, while ASTER analyzes.</p>
        </div>
        <p>(Press **ENTER** to start making decisions)</p>
    </div>

    <div class="container hidden" id="main-content">
      <h1>Future of the Earth</h1>

      <div id="planet-container">
        <canvas id="earthCanvas"></canvas>
        <div id="score">Planet Score: <span id="planetScore">100</span></div>
      </div>

      <div id="health-bar-container">
        <div id="health-bar-fill" class="health-green"></div>
      </div>

      <div id="game">
        <div id="year"></div>
        <p id="context"></p>
        <p id="warning"></p>
        <div id="choices"></div>
        <button id="next" class="hidden">Next Year</button>
        <div id="final" class="hidden"></div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="script.js"></script>

    <script>
      /**
       * Phase control module (Intro -> Context -> Timeline -> Game)
       */
      window.addEventListener("DOMContentLoaded", () => {
        // Screen References
        const intro = document.getElementById("intro-screen");
        const contextScreen = document.getElementById("context-screen");
        const timelineScreen = document.getElementById("timeline-screen");
        const mainContent = document.getElementById("main-content");
        const startButton = document.getElementById("startButton");

        /**
         * Starts the main game, calls initialization functions, and removes listeners.
         */
        function startGame() {
          mainContent.classList.remove("hidden");
          if (typeof init === "function") init();
          window.removeEventListener("keydown", handleEnter);
          startButton.removeEventListener("click", advancePhase);
        }

        /**
         * Advances the simulation to the next phase.
         */
        function advancePhase() {
            if (!intro.classList.contains("hidden")) {
                // PHASE 1 (Intro) -> PHASE 2 (Context)
                intro.classList.add("hidden");
                contextScreen.classList.remove("hidden");
            } else if (!contextScreen.classList.contains("hidden")) {
                // PHASE 2 (Context) -> PHASE 3 (Timeline)
                contextScreen.classList.add("hidden");
                timelineScreen.classList.remove("hidden");
            } else if (!timelineScreen.classList.contains("hidden")) {
                // PHASE 3 (Timeline) -> PHASE 4 (Game)
                timelineScreen.classList.add("hidden");
                startGame();
            }
        }

        /**
         * Handles the Enter key press event.
         */
        function handleEnter(event) {
          if (event.key === "Enter") {
            advancePhase();
          }
        }
        
        // Assign listeners
        window.addEventListener("keydown", handleEnter);
        startButton.addEventListener("click", advancePhase);
      });
    </script>

</body>
</html>
